
/* --------------------------------------------------------

	jQuery:Banner4 Ver.0.9.0 (Î²)
	
	(C)usosake.net / d3soso
	http://usosake.net/banana4/
	
	Released under the MIT license
	https://github.com/d3soso/banana4/blob/master/LICENSE

--------------------------------------------------------- */

!function(n){n.fn.banana4=function(i){function t(){if(q(this)){var i=this;A(this),D(this),R(this),u(this),n(window).resize(function(){e(i)}),_(this),w(this,"next")}}function e(n){R(n),Q.navi&&d(n)}function a(i){var t={};return t.outer_w=n(i).width(),t.inner_w=n(i).find("ul li").width(),t.left=(t.outer_w-t.inner_w)/2,t}function o(n){return 0>n?W+n:n>=W?n%W:n}function r(i,t,e){var o=a(i);if("prev"==t)return e*o.inner_w-2*o.inner_w+o.left;if("next"==t){var r=n(i).find("ul li").length-1;return-1*(r-e)*o.inner_w+2*o.inner_w+o.left}}function u(n){Q.navi&&s(n),Q.pager&&c(n)}function c(i){for(var t='<div class="banana4_pager">',e=0;W>e;e++){var a=0==e?" banana4_pager_on":"";t+='<a href="javascript:void(0);" class="banana4_pager'+e+a+'">&nbsp;</a>'}t+="</div>",n(i).append(t),f(i),l(i)}function f(i){n(i).find(".banana4_pager a");n(i).find(".banana4_pager").css({minWidth:"1px",position:"absolute",left:"50%",top:"100%"}),n(i).find(".banana4_pager").css({margin:"-"+2*n(i).find(".banana4_pager").height()+"px 0 0 -"+n(i).find(".banana4_pager").width()/2+"px"})}function l(i){n(i).find(".banana4_pager a").each(function(t){n(this).on("click",function(){w(i,j(i,t))})})}function s(n){h(n,"next"),h(n,"prev"),d(n),p(n,"next"),p(n,"prev")}function h(i,t){var e='<div class="banana4_navi banana4_navi_'+t+'">';e+='<a href="javascript:void(0);">&nbsp;</a>',e+="</div>",n(i).append(e)}function d(i){var t=a(i);n(i).find(".banana4_navi").css({display:"block",position:"absolute",top:0,width:t.left+"px",height:Q.inner_height}),n(i).find(".banana4_navi_next").css({left:t.left+t.inner_w+"px"}),n(i).find(".banana4_navi a").css({display:"block",position:"absolute",top:0,left:0,width:"100%",height:Q.inner_height})}function p(i,t){n(i).find(".banana4_navi_"+t+" a").on("click",function(){var n="next"==t?F.current+1:F.current-1;j(i,n),w(i,t)})}function _(i){n(i).find("ul li").each(function(){v(i,this)})}function v(i,t){n(t).on({touchstart:function(){g(i,event,"touch")},touchmove:function(){b(i,event,"touch")},touchend:function(){x(i)}})}function g(i,t,e){G=!0,clearTimeout(E),H="touch"==e?t.changedTouches[0].pageX:t.pageX,H=Math.floor(H)-0,n(i).find("ul li").each(function(){n(i).velocity?n(this).velocity("stop"):n(this).stop(),J.push(n(this).css("left").slice(0,-2)-0)})}function b(i,t,e){G&&("touch"==e&&t.preventDefault(),I="touch"==e?t.changedTouches[0].pageX:t.pageX,I=Math.floor(I)-0,n(i).find("ul li").each(function(i){n(this).css("left",J[i]+(I-H)+"px"),console.log("move"+i+" : "+J[i]+(I-H))}))}function x(n){var i=a(n);if(Math.abs(I-H)>=.3*i.inner_w){var t=0>I-H?F.current+1:F.current-1,e=j(n,t);w(n,e)}else w(n,"next");G=!1,H=0,I=0,J=[]}function w(i,t){n(i).velocity?y(i,t):n(i).transit?m(i,t):k(i,t)}function m(i,t){n(i).find("ul li").each(function(e){var a=this;n(this).stop(),n(this).transition({left:r(i,t,e)+"px",duration:Q.duration,easing:Q.easing},function(){X(i,a),Q.auto&&0==e&&T(i,"next")})})}function y(i,t){n(i).find("ul li").each(function(e){var a=this;n(this).velocity("stop"),n(this).velocity({left:r(i,t,e)+"px"},{duration:Q.duration,easing:Q.easing,complete:function(){X(i,a),Q.auto&&0==e&&T(i,"next")}})})}function k(i,t){n(i).find("ul li").each(function(e){var a=this;n(this).stop(),n(this).animate({left:r(i,t,e)+"px"},Q.duration,Q.easing,function(){X(i,a),Q.auto&&0==e&&T(i,"next")})})}function T(n,i){E=setTimeout(function(){j(n,F.current+1),w(n,i)},Q.delay)}function X(i,t){var e=a(i),r=n(t).css("left").slice(0,-2);r<-1*e.inner_w*2+e.left?(n(t).remove(),F.prev=o(F.prev+1)):r>2*e.inner_w+e.left&&(n(t).remove(),F.next=o(F.next-1))}function j(i,t){clearTimeout(E);var e=t-F.current,r=e>0?"next":"prev",u="next"==r?F.next+1:F.prev+e,c="next"==r?F.next+e:F.prev-1,f=(a(i),0),l=0;if("next"==r)for(l=u;c>=l;l++)f=n(i).find("ul li:last").css("left").slice(0,-2)-0,n(i).find("ul").append('<li class="banana4_li_'+B+'">'+O[o(l)]+"</li>"),M(i,f),v(i,n(i).find(".banana4_li_"+B)),B++;else if("prev"==r)for(l=c;l>=u;l--)f=n(i).find("ul li:first").css("left").slice(0,-2)-0,n(i).find("ul").prepend('<li class="banana4_li_'+B+'">'+O[o(l)]+"</li>"),M(i,f),v(i,n(i).find(".banana4_li_"+B)),B++;return F.current=o(t),F[r]=o("next"==r?c:u),Q.pager&&n(i).find(".banana4_pager").length>0&&(n(i).find(".banana4_pager_on").removeClass("banana4_pager_on"),n(i).find(".banana4_pager a:eq("+F.current+")").addClass("banana4_pager_on")),r}function M(i,t){n(i).find("li.banana4_li_"+B).css(C()),n(i).find("li.banana4_li_"+B).css({left:t+"px"})}function R(i){n(i).css({width:Q.outer_width,height:Q.outer_height}),n(i).css({width:Q.outer_width,height:Q.outer_height,overflow:"hidden",position:"relative"}),n(i).find("ul li").css(C()),n(i).find("ul li").each(function(t){n(this).css({left:r(i,"next",t)+"px"})})}function C(){return{display:"block",width:Q.inner_width,height:Q.inner_height,textAlign:"center",position:"absolute",top:0}}function q(){var n=[];return 0==n.length?!0:(z(n),!1)}function z(n){for(var i=0;i<n.length;i++)alert("ERROR : "+n[i].message)}function A(i){Q.inner_height||(Q.inner_height="auto"),Q.outer_width||(Q.outer_width="100%"),Q.outer_height||(Q.outer_height=n(i).find("ul li").height()+"px"),Q.inner_width||(Q.inner_width=n(i).width()+"px"),0!=Q.duration&&(Q.duration||(Q.duration=500)),Q.easing||(Q.easing="linear"),Q.navi||(Q.navi=!1),Q.pager||(Q.pager=!1),0!=Q.delay&&(Q.delay||(Q.delay=5e3)),Q.auto||(Q.auto=!1)}function D(i){W=n(i).find("ul li").length,n(i).find("ul li").each(function(){O.push(n(this).html()),n(this).remove()});for(var t=0;5>t;t++)n(i).find("ul").append('<li class="banana4_li_'+B+'">'+O[o(O.length+t-2)]+"</li>"),B++;F={current:0,prev:o(-2),next:o(2)}}var E,O=[],Q=i,W=0,B=0,F={current:0,prev:0,next:0},G=!1,H=0,I=0,J=[];return this.each(t)}}(jQuery);
